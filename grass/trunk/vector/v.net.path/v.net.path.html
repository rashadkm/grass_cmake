<h2>DESCRIPTION</h2>

<em>v.net.path</em> determines least costly, e.g. shortest or fastest 
path(s) on a vector network.

<p>
Costs may be either line lengths, or attributes saved in a database 
table. These attribute values are taken as costs of whole segments, not 
as costs to traverse a length unit (e.g. meter) of the segment. 
For example, if the speed limit is 100 km / h, the cost to traverse a 
10 km long road segment must be calculated as 
length / speed = 10 km / (100 km/h) = 0.1 h.
Supported are cost assignments for both arcs and nodes, 
and also different costs for both directions of a vector line. 
For areas, costs will be calculated along boundary lines.
<p>
The input vector needs to be prepared with <em>v.net operation=connect</em> 
in order to connect points representing center nodes to the network.

<p>
Nodes and arcs can be closed using cost = -1. 
<p>
Least cost paths are written to the output vector map with an 
attached attribute table.
<P>
Nodes can be piped into the program from file or from stdin. The
syntax is as follows:
<div class="code"><pre>
id start_point_category end_point_category
</pre></div>

or

<div class="code"><pre>
id start_point_x start_point_y end_point_x end_point_y
</pre></div>

<p>
Points specified by category must be exactly on network nodes, and the 
input vector map needs to be prepared with <em>v.net operation=connect</em>.
<p>
When specifying coordinates, the next network node to a given coordinate 
pair is used.

<p>
The attribute table will contain the following attributes:
</p>
<ul>
    <li>cat  - path unique category assigned by module</li>
    <li>id   - path id (read from input)</li>
    <li>fcat - from point category</li>
    <li>tcat - to point category</li>
    <li>sp - result status:
    <ul>
        <li>     0 - OK, path found</li>
        <li>     1 - node is not reachable</li>
        <li>     2 - point of given category does not exist</li>
    </ul></li>
    <li>cost - travelling costs (on the network, not to/from network)</li>
    <li>fdist - the distance from first point to the network</li>
    <li>tdist - the distance from the network to second point</li>
</ul>

<h2>NOTES</h2>
Nodes and arcs can be closed using cost = -1. 
<p>
If the cost columns 'afcol', 'abcol' and 'ncol' are not
specified, the length of network segments is measured and 
zero costs are assumed for nodes.
<P>
When using attributes, the length of segments is not used. To get
accurate results, the line length must be taken into account when 
assigning costs as attributes. For example, to get the <b>fastest path</b>, 
the columns 'max_speed' and 'length' are required. The correct fastest 
path can then be found by specifying <tt>afcol=length/max_speed</tt>. If needed,
the line length can be calculated and written to the attributes table 
by <em>v.to.db</em>.

<h2>EXAMPLE</h2>

Fastest path between two digitized nodes (Spearfish):

<div class="code"><pre>
echo "1|601653.5|4922869.2|start
2|593330.8|4924096.6|end" | v.in.ascii cat=1 x=2 y=3 out=startend col="cat integer, \
                         east double precision, north double precision, label varchar(43)"

v.db.select startend

# create unique categories for each road in layer 2
v.category in=roads out=myroads opt=add cat=1 layer=2

# add new table for layer 2
v.db.addtable myroads layer=2 col="cat integer,label varchar(43),length double precision,speed double precision,forward double precision,backward double precision"

# copy road type to layer 2
v.to.db myroads layer=2 qlayer=1 opt=query qcolumn=label columns=label

# connect points to road network (take care of layers)
v.net myroads points=startend out=myroads_net op=connect thresh=200 alayer=2 nlayer=1

# upload road length in miles
v.to.db map=myroads_net layer=2 type=line option=length col=length unit=miles

# set speed limits in miles / hour
v.db.update myroads_net layer=2 col=speed val="5.0"
v.db.update myroads_net layer=2 col=speed val="75.0" where="label='interstate'"
v.db.update myroads_net layer=2 col=speed val="75.0" where="label='primary highway, hard surface'"
v.db.update myroads_net layer=2 col=speed val="50.0" where="label='secondary highway, hard surface'"
v.db.update myroads_net layer=2 col=speed val="25.0" where="label='light-duty road, improved surface'"
v.db.update myroads_net layer=2 col=speed val="5.0" where="label='unimproved road'"

# define traveling costs as traveling time in hours:

# set forward costs
v.db.update myroads_net layer=2 col=forward val="length / speed"
# set backward costs
v.db.update myroads_net layer=2 col=backward val="length / speed"

g.region vect=myroads_net
d.mon x0
d.vect myroads_net
d.vect startend col=red

d.vect myroads_net icon=basic/triangle fcol=green size=12 layer=2
d.vect myroads_net disp=cat type=point lsize=14 layer=2
# ... the 'start' and 'end' nodes have category number 1 and 2

# Fastest path: ID as first number, then cat1 and cat2
echo "1 1 2" | v.net.path myroads_net afcol=forward abcol=backward out=mypath

d.vect mypath col=red width=2
</pre></div>

<img src="vnetpath.png" alt="v.net.path example" border="1">


<h2>SEE ALSO</h2>

<em><a HREF="d.path.html">d.path</a></em>,
<em><a HREF="v.net.html">v.net</a></em>,
<em><a HREF="v.net.alloc.html">v.net.alloc</a></em>,
<em><a HREF="v.net.iso.html">v.net.iso</a></em>,
<em><a HREF="v.net.salesman.html">v.net.salesman</a></em>,
<em><a HREF="v.net.steiner.html">v.net.steiner</a></em>,
<em><a HREF="v.to.db.html">v.to.db</a></em>

<h2>AUTHOR</h2>

Radim Blazek, ITC-Irst, Trento, Italy<br>
Documentation: Markus Neteler

<p><i>Last changed: $Date$</i>
