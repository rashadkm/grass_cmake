This code should go (after revision) into grass51.

Thanks to the contributors!

Markus
