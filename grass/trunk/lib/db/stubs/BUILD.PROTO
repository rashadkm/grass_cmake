tmp=/tmp/$$
rm -f $tmp
make.proto *.c > $tmp
awk '/^#undef/{next}/^ *#/{print}' $tmp
echo ""
cat $tmp | \
    awk '/^struct /{print "REMOVED:" $0 > "/dev/tty"; next}{print}' | \
    awk '/db_/ {printf "%s %s",$2,$1
	        for (i=3; i<=NF; i++) printf (" %s", $i)
		print ""
		}' | \
    sort -d | \
    awk '{type = $2}
	 {name = $1}
	 name ~ /^\*/ {type = type " *"; name = substr(name,2,length(name))}
	 {printf ("%-5s %-25s",type,name)
	  for (i=3; i<=NF; i++) printf (" %s", $i)
	  print ""
	 } '
echo ""
awk '/^#undef/{print}' $tmp
rm -f $tmp
