update to FP
improve speed
